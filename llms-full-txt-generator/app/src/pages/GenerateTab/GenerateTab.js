import './GenerateTab.css';
import ToggleSwitch from '../../components/ToggleSwitch/ToggleSwitch';
import UpgradeBanner from '../../components/UpgradeBanner/UpgradeBanner';

const GenerateTab = ({ data, setData, generating, onGenerate, onDelete }) => {
  const toggleFile = (value) => {
    const files = data.filesToGenerate.map(f =>
      f.value === value ? { ...f, checked: !f.checked } : f
    );
    setData({ ...data, filesToGenerate: files });
  };

  const hasExistingFiles = data.existingFiles['llms.txt'] || data.existingFiles['llms-full.txt'];

  return (
    <div className="generate-tab-wrapper">
      {/* LEFT: Main Content */}
      <div className="generate-main-content">
        <div className="generate-section">
          <h3>Select Files to Generate</h3>

          <div className="files-checkboxes">
            {data.filesToGenerate.map(f => (
              <label key={f.value} className="file-checkbox">
                <ToggleSwitch
                  checked={f.checked}
                  onChange={() => toggleFile(f.value)}
                />
                <div className="file-info">
                  <strong>{f.value}</strong>
                  <p>
                    {f.value === 'llms.txt'
                      ? 'Basic list of content with titles and URLs'
                      : 'Detailed content including full text and excerpts'}
                  </p>
                </div>
              </label>
            ))}
          </div>

          <button
            className="generate-btn"
            onClick={() => onGenerate(data)}
            disabled={generating}
          >
            {generating ? (
              'Generating...'
            ) : hasExistingFiles ? (
              <div className="regen-container">
                <div className="regen-text">Re-generate</div>
                <div className="regen-icon">
                  <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M17.5 3.75V7.5C17.5 7.66576 17.4342 7.82473 17.3169 7.94194C17.1997 8.05915 17.0408 8.125 16.875 8.125H13.125C12.9592 8.125 12.8003 8.05915 12.6831 7.94194C12.5658 7.82473 12.5 7.66576 12.5 7.5C12.5 7.33424 12.5658 7.17527 12.6831 7.05805C12.8003 6.94084 12.9592 6.875 13.125 6.875H15.3664L14.2234 5.73203C13.0619 4.56516 11.4847 3.90683 9.83828 3.90156H9.80313C8.17045 3.89773 6.60189 4.53677 5.43672 5.68047C5.31736 5.79189 5.15914 5.85218 4.99589 5.84843C4.83265 5.84469 4.67736 5.77721 4.56323 5.66043C4.44911 5.54365 4.38522 5.38685 4.38523 5.22356C4.38524 5.06028 4.44914 4.90348 4.56328 4.78672C5.97541 3.40656 7.87486 2.63896 9.8494 2.65052C11.8239 2.66207 13.7143 3.45184 15.1102 4.84843L16.25 5.9914V3.75C16.25 3.58424 16.3158 3.42527 16.4331 3.30805C16.5503 3.19084 16.7092 3.125 16.875 3.125C17.0408 3.125 17.1997 3.19084 17.3169 3.30805C17.4342 3.42527 17.5 3.58424 17.5 3.75ZM14.5633 14.3195C13.3866 15.4689 11.8042 16.1081 10.1593 16.0985C8.51445 16.0888 6.93968 15.4311 5.77656 14.268L4.63359 13.125H6.875C7.04076 13.125 7.19973 13.0591 7.31694 12.9419C7.43415 12.8247 7.5 12.6658 7.5 12.5C7.5 12.3342 7.43415 12.1753 7.31694 12.0581C7.19973 11.9408 7.04076 11.875 6.875 11.875H3.125C2.95924 11.875 2.80027 11.9408 2.68306 12.0581C2.56585 12.1753 2.5 12.3342 2.5 12.5V16.25C2.5 16.4158 2.56585 16.5747 2.68306 16.6919C2.80027 16.8091 2.95924 16.875 3.125 16.875C3.29076 16.875 3.44973 16.8091 3.56694 16.6919C3.68415 16.5747 3.75 16.4158 3.75 16.25V14.0086L4.89297 15.1516C6.28688 16.5525 8.18 17.3427 10.1562 17.3484H10.1977C12.1571 17.3535 14.0396 16.5864 15.4375 15.2133C15.5516 15.0965 15.6155 14.9397 15.6156 14.7764C15.6156 14.6131 15.5517 14.4563 15.4375 14.3396C15.3234 14.2228 15.1681 14.1553 15.0049 14.1516C14.8416 14.1478 14.6834 14.2081 14.5641 14.3195H14.5633Z" fill="white" />
                  </svg>
                </div>
              </div>
            ) : (
              <div className="regen-container">
                <div className="regen-text">Generate</div>
                <div className="regen-icon">
                  <svg width="17" height="13" viewBox="0 0 17 13" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M16.0672 4.81754L12.3172 8.56754C12.1999 8.68481 12.0409 8.7507 11.875 8.7507C11.7091 8.7507 11.5501 8.68481 11.4328 8.56754C11.3155 8.45026 11.2497 8.2912 11.2497 8.12535C11.2497 7.9595 11.3155 7.80044 11.4328 7.68316L14.1164 5.00035H8.125C6.30227 5.00242 4.55479 5.72741 3.26592 7.01627C1.97706 8.30514 1.25207 10.0526 1.25 11.8753C1.25 12.0411 1.18415 12.2001 1.06694 12.3173C0.949731 12.4345 0.79076 12.5003 0.625 12.5003C0.45924 12.5003 0.300269 12.4345 0.183058 12.3173C0.065848 12.2001 0 12.0411 0 11.8753C0.00227486 9.72116 0.85903 7.65586 2.38227 6.13262C3.90551 4.60938 5.97081 3.75262 8.125 3.75035H14.1164L11.4328 1.06753C11.3747 1.00947 11.3287 0.940528 11.2973 0.864658C11.2658 0.788787 11.2497 0.707469 11.2497 0.625347C11.2497 0.543226 11.2658 0.461908 11.2973 0.386037C11.3287 0.310167 11.3747 0.241229 11.4328 0.18316C11.5501 0.0658846 11.7091 0 11.875 0C11.9571 0 12.0384 0.0161751 12.1143 0.0476018C12.1902 0.0790284 12.2591 0.125091 12.3172 0.18316L16.0672 3.93316C16.1253 3.99121 16.1714 4.06014 16.2029 4.13601C16.2343 4.21188 16.2505 4.29321 16.2505 4.37535C16.2505 4.45748 16.2343 4.53881 16.2029 4.61469C16.1714 4.69056 16.1253 4.75949 16.0672 4.81754Z" fill="white" />
                  </svg>
                </div>
              </div>
            )}
          </button>
        </div>

        {/* Existing Files List */}
        <div className="existing-files">
          {Object.entries(data.existingFiles).map(([file, url]) =>
            url ? (
              <div key={file} className="file-item">
                <div className="file-link">
                  <a href={url} target="_blank" rel="noopener noreferrer">
                    <div className="file-label-container">
                      <div className="file-label">
                        {file === 'llms.txt' ? 'View LLMS.txt file' : 'View LLMS-Full.txt file'}
                      </div>
                      <div className="file-svg-label">
                        <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <path d="M17.389 8.77219C17.3644 8.71664 16.7688 7.39547 15.4448 6.07148C13.6807 4.30734 11.4525 3.375 8.99999 3.375C6.54749 3.375 4.31929 4.30734 2.55515 6.07148C1.23117 7.39547 0.632806 8.71875 0.611009 8.77219C0.579026 8.84413 0.5625 8.92198 0.5625 9.0007C0.5625 9.07943 0.579026 9.15728 0.611009 9.22922C0.635618 9.28477 1.23117 10.6052 2.55515 11.9292C4.31929 13.6927 6.54749 14.625 8.99999 14.625C11.4525 14.625 13.6807 13.6927 15.4448 11.9292C16.7688 10.6052 17.3644 9.28477 17.389 9.22922C17.421 9.15728 17.4375 9.07943 17.4375 9.0007C17.4375 8.92198 17.421 8.84413 17.389 8.77219ZM8.99999 13.5C6.83577 13.5 4.94507 12.7132 3.37991 11.1621C2.73771 10.5235 2.19134 9.7952 1.75781 9C2.19123 8.20472 2.73761 7.47645 3.37991 6.83789C4.94507 5.2868 6.83577 4.5 8.99999 4.5C11.1642 4.5 13.0549 5.2868 14.6201 6.83789C15.2635 7.4763 15.8111 8.20457 16.2457 9C15.7387 9.94641 13.5302 13.5 8.99999 13.5ZM8.99999 5.625C8.33248 5.625 7.67996 5.82294 7.12494 6.19379C6.56993 6.56464 6.13734 7.09174 5.8819 7.70844C5.62645 8.32514 5.55962 9.00374 5.68984 9.65843C5.82007 10.3131 6.1415 10.9145 6.61351 11.3865C7.08551 11.8585 7.68688 12.1799 8.34156 12.3102C8.99625 12.4404 9.67485 12.3735 10.2915 12.1181C10.9082 11.8626 11.4354 11.4301 11.8062 10.875C12.1771 10.32 12.375 9.66751 12.375 9C12.3741 8.10518 12.0182 7.24728 11.3855 6.61454C10.7527 5.98181 9.89481 5.62593 8.99999 5.625ZM8.99999 11.25C8.55498 11.25 8.11997 11.118 7.74996 10.8708C7.37995 10.6236 7.09156 10.2722 6.92126 9.86104C6.75097 9.4499 6.70641 8.9975 6.79323 8.56105C6.88004 8.12459 7.09433 7.72368 7.409 7.40901C7.72367 7.09434 8.12458 6.88005 8.56104 6.79323C8.9975 6.70642 9.4499 6.75097 9.86103 6.92127C10.2722 7.09157 10.6236 7.37996 10.8708 7.74997C11.118 8.11998 11.25 8.55499 11.25 9C11.25 9.59674 11.0129 10.169 10.591 10.591C10.169 11.0129 9.59673 11.25 8.99999 11.25Z" fill="#6B33C1" />
                        </svg>
                      </div>
                    </div>
                  </a>
                </div>
                <button
                  className="delete-btn"
                  onClick={() => onDelete(file)}
                  title="Delete file"
                >
                  <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M16.875 3.75H13.75V3.125C13.75 2.62772 13.5525 2.15081 13.2008 1.79917C12.8492 1.44754 12.3723 1.25 11.875 1.25H8.125C7.62772 1.25 7.15081 1.44754 6.79917 1.79917C6.44754 2.15081 6.25 2.62772 6.25 3.125V3.75H3.125C2.95924 3.75 2.80027 3.81585 2.68306 3.93306C2.56585 4.05027 2.5 4.20924 2.5 4.375C2.5 4.54076 2.56585 4.69973 2.68306 4.81694C2.80027 4.93415 2.95924 5 3.125 5H3.75V16.25C3.75 16.5815 3.8817 16.8995 4.11612 17.1339C4.35054 17.3683 4.66848 17.5 5 17.5H15C15.3315 17.5 15.6495 17.3683 15.8839 17.1339C16.1183 16.8995 16.25 16.5815 16.25 16.25V5H16.875C17.0408 5 17.1997 4.93415 17.3169 4.81694C17.4342 4.69973 17.5 4.54076 17.5 4.375C17.5 4.20924 17.4342 4.05027 17.3169 3.93306C17.1997 3.81585 17.0408 3.75 16.875 3.75ZM7.5 3.125C7.5 2.95924 7.56585 2.80027 7.68306 2.68306C7.80027 2.56585 7.95924 2.5 8.125 2.5H11.875C12.0408 2.5 12.1997 2.56585 12.3169 2.68306C12.4342 2.80027 12.5 2.95924 12.5 3.125V3.75H7.5V3.125ZM15 16.25H5V5H15V16.25ZM8.75 8.125V13.125C8.75 13.2908 8.68415 13.4497 8.56694 13.5669C8.44973 13.6842 8.29076 13.75 8.125 13.75C7.95924 13.75 7.80027 13.6842 7.68306 13.5669C7.56585 13.4497 7.5 13.2908 7.5 13.125V8.125C7.5 7.95924 7.56585 7.80027 7.68306 7.68306C7.80027 7.56585 7.95924 7.5 8.125 7.5C8.29076 7.5 8.44973 7.56585 8.56694 7.68306C8.68415 7.80027 8.75 7.95924 8.75 8.125ZM12.5 8.125V13.125C12.5 13.2908 12.4342 13.4497 12.3169 13.5669C12.1997 13.6842 12.0408 13.75 11.875 13.75C11.7092 13.75 11.5503 13.6842 11.4331 13.5669C11.3158 13.4497 11.25 13.2908 11.25 13.125V8.125C11.25 7.95924 11.3158 7.80027 11.4331 7.68306C11.5503 7.56585 11.7092 7.5 11.875 7.5C12.0408 7.5 12.1997 7.56585 12.3169 7.68306C12.4342 7.80027 12.5 7.95924 12.5 8.125Z" fill="#505C6D" />
                  </svg>
                </button>
              </div>
            ) : null
          )}
        </div>
      </div>

      {/* RIGHT: Upgrade Banner */}
      <div className="generate-sidebar">
        <UpgradeBanner />
      </div>
    </div>
  );
};

export default GenerateTab;